# ìŠ¤ë ˆë“œ (Thread)

ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹ ë°›ì•„ ì‹¤í–‰ ì¤‘ì¸ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ **í”„ë¡œì„¸ìŠ¤**ë¼ê³  í•˜ê³ ,  
í”„ë¡œì„¸ìŠ¤ ë‚´ì—ì„œ ì‹¤í–‰ë˜ëŠ” ì†ŒìŠ¤ì½”ë“œì˜ ì‹¤í–‰ íë¦„ì„ **ìŠ¤ë ˆë“œ**ë¼ê³  í•œë‹¤.

> ì‹±ê¸€ ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ : í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë¥¼ ê°€ì§€ëŠ” í”„ë¡œì„¸ìŠ¤  
> ë©€í‹° ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ : ì—¬ëŸ¬ê°œì˜ ìŠ¤ë ˆë“œë¥¼ ê°€ì§€ëŠ” í”„ë¡œì„¸ìŠ¤ë¡œ ë™ì‹œ ì‘ì—…ì´ ê°€ëŠ¥í•˜ë‹¤.  
> 
> (ëŒ€ë¶€ë¶„ì€ ë©€í‹° ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ì´ë‹¤.)

<br>

### ë©”ì¸ ìŠ¤ë ˆë“œ (Main Thread)

<br>

ë©”ì¸ ìŠ¤ë ˆë“œëŠ” ìë°” ì‹¤í–‰ì‹œ ê°€ì¥ ë¨¼ì € ì‹¤í–‰ë˜ëŠ” ```main``` ë©”ì„œë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ê³ ,  
ì½”ë“œì˜ ëì„ ë§Œë‚˜ê±°ë‚˜ returnë¬¸ì„ ë§Œë‚˜ë©´ ì‹¤í–‰ì„ ì¢…ë£Œí•œë‹¤.

> ë©”ì¸ ìŠ¤ë ˆë“œë§Œ ê°€ì§„ë‹¤ëŠ” ê²ƒì€ ì‹±ê¸€ ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ë¼ëŠ” ì˜ë¯¸ì´ê³ ,  
> ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ë˜ ë‹¤ë¥¸ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ ì‹¤í–‰í•˜ë©´ ë©€í‹° ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ë¡œ ë™ì‘í•˜ê²Œ ëœë‹¤.

<br>

### ë©€í‹° ìŠ¤ë ˆë“œ (Multi-Thread)

<br>

í•˜ë‚˜ì˜ í”„ë¡œì„¸ìŠ¤ëŠ” ì—¬ëŸ¬ ê°œì˜ ìŠ¤ë ˆë“œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ ë©€í‹° ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ë¼ í•œë‹¤.

í•˜ë‚˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ ë‚´ì—ì„œ ì—¬ëŸ¬ ì‘ì—…ì„ ë™ì‹œì— ìˆ˜í–‰í•˜ëŠ” **ë©€í‹° íƒœìŠ¤í‚¹**ì„ êµ¬í˜„í•˜ëŠ” ì—­í• ì„ í•œë‹¤.

<br>

***

<br>

## ìŠ¤ë ˆë“œì˜ ìƒì„± ë° ì‹¤í–‰

<br>

### ì‘ì—… ìŠ¤ë ˆë“œ ìƒì„± ë° ì‹¤í–‰

<br>

ì‘ì—… ìŠ¤ë ˆë“œëŠ” ë©”ì¸ ìŠ¤ë ˆë“œ ì´ì™¸ì— ë³„ë„ì˜ ì‘ì—…ì„ ìœ„í•œ ë©€í‹° ìŠ¤ë ˆë“œë¥¼ ë§í•˜ë©°,  
ì‘ì—… ìŠ¤ë ˆë“œë¥¼ í™œìš©í•œë‹¤ëŠ” ê²ƒì€ **ì‘ì—… ìŠ¤ë ˆë“œê°€ ìˆ˜í–‰í•  ì½”ë“œë¥¼ ì‘ì„±**í•˜ê³ ,  
**ì‘ì—… ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ ì‹¤í–‰**ì‹œí‚¤ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤.

ìŠ¤ë ˆë“œê°€ ìˆ˜í–‰í•  ì½”ë“œëŠ” í´ë˜ìŠ¤ ë‚´ë¶€ì— ì‘ì„±í•´ì£¼ì–´ì•¼ í•˜ë©°,  
```run()```ì´ë¼ëŠ” ë©”ì„œë“œ ë‚´ì— ìŠ¤ë ˆë“œê°€ ì²˜ë¦¬í•  ì‘ì—…ì„ ì‘ì„±í•´ì•¼í•œë‹¤.

> ```run()``` ë©”ì„œë“œëŠ” ```Runnable``` ì¸í„°í˜ì´ìŠ¤ì™€ ```Thread``` í´ë˜ìŠ¤ì— ì •ì˜ë˜ì–´ì ¸ ìˆë‹¤.   

<br>

ğŸ”¸ **ì‘ì—… ìŠ¤ë ˆë“œì˜ ìƒì„± ë° ì‹¤í–‰ ë°©ë²•**

1. ```Runnable``` ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ì—ì„œ ```run()```ì„ êµ¬í˜„í•˜ì—¬ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰

```java
public class ThreadExample1 {
    public static void main(String[] args) {
        // Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ ìƒì„±
        Runnable task1 = new ThreadTask1();
        // êµ¬í˜„ ê°ì²´ë¥¼ ì¸ìë¡œ ì „ë‹¬í•˜ë©´ì„œ Thread í´ë˜ìŠ¤ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”í•œ ìŠ¤ë ˆë“œìƒì„±
        Thread thread1 = new Thread(task1);

        // Thread thread1 = new Thread(new ThreadTask1());


        // ì‘ì—… ìŠ¤ë ˆë“œ ì‹¤í–‰ ë°©ë²• start() ë©”ì„œë“œ
        thread1.start();

        // ë©”ì¸ ìŠ¤ë ˆë“œ ë°˜ë³µë¬¸ ì‘ì„±
        for (int i = 0; i < 100; i++) {
            System.out.print("@");
        }
    }
}

// Runnable ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤
class ThreadTask1 implements Runnable {
    // ru() ë©”ì„œë“œ ë°”ë”” ë‚´ì— ì‘ì—… ìŠ¤ë ˆë“œ ë°˜ë³µë¬¸ ì‘ì„±
    public void run() {
        for (int i = 0; i < 100; i++) {
            System.out.print("#");
        }
    }
}

// ì¶œë ¥
@@@@@@@@@@@######@@@@@############################
@#########@@@@@@@@@@@@@@@@############@@@@@@@@@@@@
@@@@@@@@@@@@@@@@@@@@@@@@##@@@@@@@@@@@@@@@@@@@@@@@@
@@@@@@@###########################################
```

<br>

2. ```Thread``` í´ë˜ìŠ¤ë¥¼ ìƒì† ë°›ì€ í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ ```run()```ì„ êµ¬í˜„í•˜ì—¬ ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ê³  ì‹¤í–‰

```java
public class ThreadExample2 {
    public static void main(String[] args) {

        // Thread í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ì€ í´ë˜ìŠ¤ë¥¼ ì¸ìŠ¤í„´ìŠ¤í™”
        ThreadTask2 thread2 = new ThreadTask2();

        // ì‘ì—… ìŠ¤ë ˆë“œ ì‹¤í–‰
        thread2.start();

        // ë©”ì¸ ìŠ¤ë ˆë“œ ë°˜ë³µë¬¸ ì‘ì„±
        for (int i = 0; i < 100; i++) {
            System.out.print("@");
        }
    }
}

// Thread í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” í´ë˜ìŠ¤ ì‘ì„±
class ThreadTask2 extends Thread {
    // run() ë©”ì„œë“œ ë°”ë”” ë‚´ì— ì‘ì—… ìŠ¤ë ˆë“œ ë°˜ë³µë¬¸ ì‘ì„±
    public void run() {
        for (int i = 0; i < 100; i++) {
            System.out.print("#");
        }
    }
}
```

<br>

### ìµëª…ê°ì²´ë¥¼ ì‚¬ìš©í•˜ì—¬ ìŠ¤ë ˆë“œ ìƒì„±í•˜ê³  ì‹¤í–‰

- ```Runnable``` ìµëª… êµ¬í˜„ ê°ì²´ë¥¼ í™œìš©í•œ ìŠ¤ë ˆë“œ ìƒì„± ë° ì‹¤í–‰

```java
public class ThreadExample1 {
    public static void main(String[] args) {
				
        // ìµëª… Runnable êµ¬í˜„ ê°ì²´ë¥¼ í™œìš©í•˜ì—¬ ìŠ¤ë ˆë“œ ìƒì„±
        Thread thread1 = new Thread(new Runnable() {
            public void run() {
                for (int i = 0; i < 100; i++) {
                    System.out.print("#");
                }
            }
        });

        thread1.start();

        for (int i = 0; i < 100; i++) {
            System.out.print("@");
        }
    }
}
```

<br>

- ```Thread``` ìµëª… í•˜ìœ„ ê°ì²´ë¥¼ í™œìš©í•œ ìŠ¤ë ˆë“œ ìƒì„± ë° ì‹¤í–‰

```java
public class ThreadExample2 {
    public static void main(String[] args) {

        // ìµëª… Thread í•˜ìœ„ ê°ì²´ë¥¼ í™œìš©í•œ ìŠ¤ë ˆë“œ ìƒì„±
        Thread thread2 = new Thread() {
            public void run() {
                for (int i = 0; i < 100; i++) {
                    System.out.print("#");
                }
            }
        };

        thread2.start();

        for (int i = 0; i < 100; i++) {
            System.out.print("@");
        }
    }
}
```

<br>

***

<br>

## ìŠ¤ë ˆë“œ ì´ë¦„

ë©”ì¸ìŠ¤ë ˆë“œëŠ” ```main```ì´ë¼ëŠ” ì´ë¦„ì„ ê°€ì§€ë©°,  
ê·¸ ì™¸ì— ì¶”ê°€ì ìœ¼ë¡œ ìƒì„±í•œ ìŠ¤ë ˆë“œëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ```Thread-n```ì´ë¼ëŠ” ì´ë¦„ì„ ê°€ì§€ê³  ìˆë‹¤.

<br>

### ìŠ¤ë ˆë“œ ì´ë¦„ ì¡°íšŒ

```java
// ì„ì˜ì˜ ìŠ¤ë ˆë“œ
Thread thread = new Thread(new Runnable() {
    public void run() {
        System.out.println("Get Thread Name");
    }
});

System.out.println(thread.getName());

// ì¶œë ¥
Get Thread Name
Thread-0
```

<br>

### ìŠ¤ë ˆë“œ ì´ë¦„ ì„¤ì •

```java
// ì„ì˜ì˜ ìŠ¤ë ˆë“œ
Thread thread = new Thread(new Runnable() {
            public void run() {
                System.out.println("Set And Get Thread Name");
            }
        });

thread.setName("Modified Thread Name");

System.out.println(thread.getName());

// ì¶œë ¥
Set And Get Thread Name
Modified Thread Name
```

<br>

### ìŠ¤ë ˆë“œ ì¸ìŠ¤í„´ìŠ¤ì˜ ì£¼ì†Œê°’ ì–»ê¸°

<br>

ì‹¤í–‰ ì¤‘ì¸ ìŠ¤ë ˆë“œì˜ ì£¼ì†Œê°’ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•œë‹¤ë©´  
```Thread``` í´ë˜ìŠ¤ì˜ ì •ì  ë©”ì„œë“œì¸ ```currentThread()```ë¥¼ ì‚¬ìš©í•˜ë©´ ëœë‹¤.

```java
Thread thread = new Thread(new Runnable() {
            public void run() {
                System.out.println(Thread.currentThread().getName());   // Thread-0
            }
        });

thread.start();
System.out.println(Thread.currentThread().getName());   // main
```

<br>

***

<br>

## ìŠ¤ë ˆë“œ ë™ê¸°í™”

ì‹±ê¸€ ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ëŠ” ë°ì´í„°ì— ë‹¨ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì ‘ê·¼í•˜ë¯€ë¡œ ë¬¸ì œë  ì‚¬í•­ì´ ì—†ì§€ë§Œ  
ë©€í‹° ìŠ¤ë ˆë“œ í”„ë¡œì„¸ìŠ¤ì˜ ê²½ìš°, ë‘ ìŠ¤ë ˆë“œê°€ ë™ì¼í•œ ë°ì´í„°ë¥¼ ê³µìœ í•˜ê²Œ ë˜ì–´ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆë‹¤.

```java
try { Thread.sleep(1000); } catch (Exception error) {}
```

```java
Thread.sleep(1000);
```

â–² _ìŠ¤ë ˆë“œë¥¼ ì¼ì‹œ ì •ì§€ì‹œí‚¤ëŠ” ë©”ì„œë“œ_

<br>

**ì–´ë–¤ ìŠ¤ë ˆë“œê°€ ì¼ì‹œ ì •ì§€ë˜ë©´, ëŒ€ê¸°ì—´ì—ì„œ ê¸°ë‹¤ë¦¬ê³  ìˆë˜ ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ëœë‹¤.**

ë˜í•œ, ```Thread.sleep()```ì€ ë°˜ë“œì‹œ try-catchë¬¸ì˜ ```try``` ë¸”ëŸ­ ë‚´ì— ì‘ì„±í•´ì•¼ í•œë‹¤.

<br>

```java
public class ThreadExample {
    public static void main(String[] args) {

        Runnable threadTask3 = new ThreadTask3();
        Thread thread3_1 = new Thread(threadTask3);
        Thread thread3_2 = new Thread(threadTask3);

        thread3_1.setName("ê¹€ì½”ë”©");
        thread3_2.setName("ë°•ìë°”");

        thread3_1.start();
        thread3_2.start();
    }
}

class Account {

    // ì”ì•¡ì„ ë‚˜íƒ€ë‚´ëŠ” ë³€ìˆ˜
    private int balance = 1000;

    public int getBalance() {
        return balance;
    }
		
    // ì¸ì¶œ ì„±ê³µ ì‹œ true, ì‹¤íŒ¨ ì‹œ false ë°˜í™˜
    public boolean withdraw(int money) {

        // ì¸ì¶œ ê°€ëŠ¥ ì—¬ë¶€ íŒë‹¨
        if (balance >= money) {

            // ifë¬¸ì˜ ì‹¤í–‰ë¶€ì— ì§„ì…í•˜ìë§ˆì í•´ë‹¹ ìŠ¤ë ˆë“œë¥¼ ì¼ì‹œ ì •ì§€ ì‹œí‚¤ê³ , 
            // ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ê²Œ ì œì–´ê¶Œì„ ê°•ì œë¡œ ë„˜ê¸´ë‹¤.
            // ì¼ë¶€ëŸ¬ ë¬¸ì œ ìƒí™©ì„ ë°œìƒì‹œí‚¤ê¸° ìœ„í•´ ì¶”ê°€í•œ ì½”ë“œ
            try { Thread.sleep(1000); } catch (Exception error) {}

            // ì”ì•¡ì—ì„œ ì¸ì¶œê¸ˆì„ ê¹ì•„ ìƒˆë¡œìš´ ì”ì•¡ì„ ê¸°ë¡
            balance -= money;

            return true;
        }
        return false;
    }
}

class ThreadTask3 implements Runnable {
    Account account = new Account();

    public void run() {
        while (account.getBalance() > 0) {

            // 100 ~ 300ì›ì˜ ì¸ì¶œê¸ˆì„ ëœë¤ìœ¼ë¡œ ì •í•¨
            int money = (int)(Math.random() * 3 + 1) * 100;

            // withdrawë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ë™ì‹œì— ì¸ì¶œ ì„±ê³µ ì—¬ë¶€ë¥¼ ë³€ìˆ˜ì— í• ë‹¹
            boolean denied = !account.withdraw(money);

            // ì¸ì¶œ ê²°ê³¼ í™•ì¸
            // ë§Œì•½, withrawê°€ falseë¥¼ ë¦¬í„´í•˜ì˜€ë‹¤ë©´, í•´ë‹¹ ë‚´ì—­ì— -> DENIEDë¥¼ ì¶œë ¥
            System.out.println(String.format("Withdraw %dâ‚© By %s. Balance : %d %s",
                    money, Thread.currentThread().getName(), account.getBalance(), denied ? "-> DENIED" : "")
            );
        }
    }
}

// ì¶œë ¥
Withdraw 100â‚© By ê¹€ì½”ë”©. Balance : 600 
Withdraw 300â‚© By ë°•ìë°”. Balance : 600 
Withdraw 200â‚© By ê¹€ì½”ë”©. Balance : 400 
Withdraw 200â‚© By ë°•ìë°”. Balance : 200 
Withdraw 200â‚© By ê¹€ì½”ë”©. Balance : -100 
Withdraw 100â‚© By ë°•ìë°”. Balance : -100 

Process finished with exit code 0
```

<br>

> ğŸ’¡ ìŒìˆ˜ì˜ ì”ì•¡ì´ ë°œìƒí•˜ëŠ” ì´ìœ  :  
> 
> ë‘ ìŠ¤ë ˆë“œê°€ í•˜ë‚˜ì˜ ```Account``` ê°ì²´ë¥¼ ê³µìœ í•˜ëŠ” ìƒí™©ì—ì„œ,  
> í•œ ìŠ¤ë ˆë“œê°€ if ë¬¸ì˜ ì¡°ê±´ì‹ì„ ```true```ë¡œ í‰ê°€í•˜ì—¬ ifë¬¸ì˜ ì‹¤í–‰ë¶€ë¡œ ì½”ë“œì˜ íë¦„ì´ ì´ë™í•˜ëŠ” ì‹œì ì— **ë‹¤ë¥¸ ìŠ¤ë ˆë“œê°€ ë¼ì–´ë“¤ì–´** balanceë¥¼ ì¸ì¶œí–ˆê¸° ë•Œë¬¸ì´ë‹¤.
> 
> ì¶”ê°€ë¡œ ì•Œ ìˆ˜ ì—†ëŠ” ì›ì¸ì— ì˜í•´ ì¸ì¶œì— ì‹¤íŒ¨í•œ ê²½ìš°ì— -> DENIEDê°€ ì œëŒ€ë¡œ ì¶œë ¥ë˜ì§€ ì•ŠëŠ” ë¬¸ì œë„ ë°œìƒ

<br>

### ì„ê³„ ì˜ì—­(Critical section)ê³¼ ë½(Lock)

<br>

- ì„ê³„ ì˜ì—­ : **ì˜¤ë¡œì§€ í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ì½”ë“œë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” ì½”ë“œ ì˜ì—­**  
  íŠ¹ì • ì½”ë“œ êµ¬ê°„ì„ ì„ê³„ ì˜ì—­ìœ¼ë¡œ ì„¤ì •í•  ë•Œì—ëŠ” ```synchronized```ë¼ëŠ” í‚¤ì›Œë“œë¥¼ ì‚¬ìš©  

- ë½ : ì„ê³„ ì˜ì—­ì„ í¬í•¨í•˜ê³  ìˆëŠ” ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” ê¶Œí•œ

<br>


ğŸ”¸ **```synchronized``` í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•**

<br>

1. ë©”ì„œë“œ ì „ì²´ë¥¼ ì„ê³„ ì˜ì—­ìœ¼ë¡œ ì§€ì •

```java
class Account {
	...
    // synchronized í‚¤ì›Œë“œë¥¼ ì‘ì„±í•˜ì—¬ ë©”ì„œë“œ ì „ì²´ë¥¼ ì„ê³„ ì˜ì—­ìœ¼ë¡œ ë§Œë“¬
	public synchronized boolean withdraw(int money) {
	    if (balance >= money) {
	        try { Thread.sleep(1000); } catch (Exception error) {}
	        balance -= money;
	        return true;
	    }
	    return false;
	}
}
```


2. íŠ¹ì •í•œ ì˜ì—­ì„ ì„ê³„ ì˜ì—­ìœ¼ë¡œ ì§€ì •

íŠ¹ì • ì˜ì—­ì„ ì„ê³„ ì˜ì—­ìœ¼ë¡œ ì§€ì •í•˜ë ¤ë©´ ```synchronized``` í‚¤ì›Œë“œì™€ í•¨ê»˜  
ì†Œê´„í˜¸(```()```) ì•ˆì— í•´ë‹¹ ì˜ì—­ì´ í¬í•¨ëœ ê°ì²´ì˜ ì°¸ì¡°ë¥¼ ë„£ê³ ,  
ì¤‘ê´„í˜¸(```{}```)ë¡œ ë¸”ëŸ­ì„ ì—´ì–´, ë¸”ëŸ­ ë‚´ì— ì½”ë“œ ì‘ì„±

```java
class Account {
	...
	public boolean withdraw(int money) {
        // ì°¸ì¡°ëŠ” ë³´í†µ this
        synchronized (this) {
            // ë¸”ëŸ­ ë‚´ì— ì½”ë“œ ì‘ì„±
            if (balance >= money) {
                try { Thread.sleep(1000); } catch (Exception error) {}
                balance -= money;
                return true;
            }
            return false;
        }
	}
}
```

<br>

***

<br>

## ìŠ¤ë ˆë“œì˜ ìƒíƒœì™€ ì‹¤í–‰ ì œì–´

ìœ„ì—ì„œ ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•´ ```start()``` ë©”ì„œë“œë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ,  
```start()```ëŠ” ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ë©”ì„œë“œëŠ” ì•„ë‹ˆë‹¤.

```start()```ëŠ” ìŠ¤ë ˆë“œì˜ ìƒíƒœë¥¼ **ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœ**ë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ë©”ì„œë“œì´ë©°,  
ì–´ë–¤ ìŠ¤ë ˆë“œê°€ ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœê°€ ë˜ë©´ ìš´ì˜ì²´ì œê°€ ì ì ˆí•œ ë•Œì— ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.


> ì¦‰, ìŠ¤ë ˆë“œì—ëŠ” ìƒíƒœë¼ëŠ” ê²ƒì´ ì¡´ì¬í•œë‹¤.  
> 
> ë˜í•œ, ìŠ¤ë ˆë“œì˜ ìƒíƒœë¥¼ ë°”ê¿€ ìˆ˜ ìˆëŠ” ë©”ì„œë“œê°€ ì¡´ì¬í•œë‹¤.


<br>

<img src = "https://miro.medium.com/max/700/1*ZB4kgrJkAN-eVv1OIwMrpw.jpeg" />

â–² _Thread State Diagram_

<br>

### ìŠ¤ë ˆë“œ ì‹¤í–‰ ì œì–´ ë©”ì„œë“œ

<br>

**```sleep(long milliSecond)``` : milliSecond ë™ì•ˆ ìŠ¤ë ˆë“œë¥¼ ì ì‹œ ë©ˆì¶¤**

<br>

```sleep()```ì€ ```Thread```ì˜ í´ë˜ìŠ¤ ë©”ì„œë“œì´ê¸° ë•Œë¬¸ì—  
```Thread.sleep(1000);```ê³¼ ê°™ì´ í´ë˜ìŠ¤ë¥¼ í†µí•´ì„œ í˜¸ì¶œí•˜ëŠ” ê²ƒì´ ê¶Œì¥ëœë‹¤.

```sleep()```ì— ì˜í•´ ì¼ì‹œ ì •ì§€ëœ ìŠ¤ë ˆë“œëŠ” ë‹¤ìŒì˜ ê²½ìš°ì— ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœë¡œ ë³µê·€í•œë‹¤.

- ì¸ìë¡œ ì „ë‹¬í•œ ì‹œê°„ ë§Œí¼ì˜ ì‹œê°„ì´ ê²½ê³¼í•œ ê²½ìš°

- ```interrupt()```ë¥¼ í˜¸ì¶œí•œ ê²½ìš° : ë°˜ë“œì‹œ try-catchë¬¸ì„ ì‚¬ìš©í•´ì„œ ì˜ˆì™¸ ì²˜ë¦¬ë¥¼ í•´ì£¼ì–´ì•¼ í•œë‹¤. 

ë”°ë¼ì„œ ```sleep()```ì„ ì‚¬ìš©í•  ë•Œì—ëŠ” try-catch ë¬¸ìœ¼ë¡œ ```sleep()```ì„ ê°ì‹¸ì£¼ì–´ì•¼ í•œë‹¤.

```java
try { Thread.sleep(1000); } catch (Exception error) {}
```

<br>

**```interrupt()``` : ì¼ì‹œ ì¤‘ì§€ ìƒíƒœì¸ ìŠ¤ë ˆë“œë¥¼ ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœë¡œ ë³µê·€ì‹œí‚¨ë‹¤.**

<br>

```interrupt()```ëŠ” ```sleep()```, ```wait()```, ```join()```ì— ì˜í•´ ì¼ì‹œ ì •ì§€ ìƒíƒœì— ìˆëŠ” ìŠ¤ë ˆë“œë“¤ì„ ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœë¡œ ë³µê·€ì‹œí‚¤ëŠ” ì—­í• ì„ í•œë‹¤.

ë©ˆì¶°ìˆëŠ” ìŠ¤ë ˆë“œê°€ ì•„ë‹Œ ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ì„œ ```ë©ˆì¶° ìˆëŠ” ìŠ¤ë ˆë“œ.interrupt()```ë¥¼ í˜¸ì¶œí•˜ë©´,  
ê¸°ì¡´ì— í˜¸ì¶œë˜ì–´ ìŠ¤ë ˆë“œë¥¼ ë©ˆì¶”ê²Œ í–ˆë˜ ```sleep()```, ```wait()```, ```join()``` ë©”ì„œë“œì—ì„œ ì˜ˆì™¸ê°€ ë°œìƒë˜ë©°,  
ê·¸ì— ë”°ë¼ ì¼ì‹œ ì •ì§€ê°€ í’€ë¦¬ê²Œ ëœë‹¤.

<br>

**```yield()``` : ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ê²Œ ì‹¤í–‰ì„ ì–‘ë³´í•œë‹¤.**

<br>

```yield()```ëŠ” ë‹¤ë¥¸ ìŠ¤ë ˆë“œì—ê²Œ ìì‹ ì˜ ì‹¤í–‰ ì‹œê°„ì„ ì–‘ë³´í•œë‹¤.  
ì˜ˆë¥¼ ë“¤ì–´, ìš´ì˜ ì²´ì œì˜ ìŠ¤ì¼€ì¤„ëŸ¬ì— ì˜í•´ 3ì´ˆë¥¼ í• ë‹¹ ë°›ì€ ìŠ¤ë ˆë“œ Aê°€ 1ì´ˆ ë™ì•ˆ ì‘ì—…ì„ ìˆ˜í–‰í•˜ë‹¤ê°€ ```yield()```ë¥¼ í˜¸ì¶œí•˜ë©´ ë‚¨ì€ ì‹¤í–‰ ì‹œê°„ 2ì´ˆëŠ” ë‹¤ìŒ ìŠ¤ë ˆë“œì—ê²Œ ì–‘ë³´ëœë‹¤.

```java
public void run() {
    while (true) {
        if (example) { ... }

        // exampleì´ falseì´ë©´ whileë¬¸ì„ ë©ˆì¶”ê³ ,
        // ìš°ì„  ìˆœìœ„ê°€ ë†’ì€ ìŠ¤ë ˆë“œì—ê²Œ ì‹¤í–‰ì‹œê°„ ì–‘ë³´
        else Thread.yield();
    }
}
```
<br>

**```join()``` : ë‹¤ë¥¸ ìŠ¤ë ˆë“œì˜ ì‘ì—…ì´ ëë‚  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦°ë‹¤.**

<br>

```join()``` : íŠ¹ì • ìŠ¤ë ˆë“œê°€ ì‘ì—…í•˜ëŠ” ë™ì•ˆì— ìì‹ ì„ ì¼ì‹œ ì¤‘ì§€ ìƒíƒœë¡œ ë§Œë“œëŠ” ìƒíƒœ ì œì–´ ë©”ì„œë“œ

ğŸ’¡ ```join()```ê³¼ ```sleep()```ì˜ ìœ ì‚¬ì 

- ```join()```ì„ í˜¸ì¶œí•œ ìŠ¤ë ˆë“œëŠ” ì¼ì‹œ ì¤‘ì§€ ìƒíƒœê°€ ëœë‹¤.

- try-catchë¬¸ìœ¼ë¡œ ê°ì‹¸ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

- ```interrupt()```ì— ì˜í•´ ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœë¡œ ë³µê·€í•  ìˆ˜ ìˆë‹¤.


ğŸ’¡ ```join()```ê³¼ ```sleep()```ì˜ ì°¨ì´ì 

- ```sleep()``` : ```Thread``` í´ë˜ìŠ¤ì˜ static ë©”ì„œë“œ

- ```join()``` : íŠ¹ì • ìŠ¤ë ˆë“œì— ëŒ€í•´ ë™ì‘í•˜ëŠ” ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œ

> ```Thread.sleep(1000);```
> 
> ```thread1.join();```

<br>

**```wait()```, ```notify()``` : ìŠ¤ë ˆë“œ ê°„ í˜‘ì—…ì— ì‚¬ìš©**

<br>

ë‘ ìŠ¤ë ˆë“œê°€ êµëŒ€ë¡œ ì‘ì—…ì„ ì²˜ë¦¬í•´ì•¼í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œ

1. ìŠ¤ë ˆë“œAê°€ ê³µìœ  ê°ì²´ì— ìì‹ ì˜ ì‘ì—…ì„ ì™„ë£Œí•œë‹¤.  
  ì´ ë•Œ, ìŠ¤ë ˆë“œBì™€ êµëŒ€í•˜ê¸° ìœ„í•´ ```notify()```ë¥¼ í˜¸ì¶œí•œë‹¤.  

2. ```notify()```ê°€ í˜¸ì¶œë˜ë©´ ìŠ¤ë ˆë“œBê°€ ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœê°€ ë˜ë©°, ê³§ ì‹¤í–‰ëœë‹¤.  

3. ì´ì–´ì„œ ìŠ¤ë ˆë“œAëŠ” ```wait()```ì„ í˜¸ì¶œí•˜ë©° ìê¸° ìì‹ ì„ ì¼ì‹œ ì •ì§€ ìƒíƒœë¡œ ë§Œë“ ë‹¤.

4. ì´í›„ ìŠ¤ë ˆë“œBê°€ ì‘ì—…ì„ ì™„ë£Œí•˜ë©´ ```notify()```ë¥¼ í˜¸ì¶œí•˜ì—¬ ì‘ì—…ì„ ì¤‘ë‹¨í•˜ê³  ìˆë˜ ìŠ¤ë ˆë“œAë¥¼ ë‹¤ì‹œ ì‹¤í–‰ ëŒ€ê¸° ìƒíƒœë¡œ ë³µê·€ì‹œí‚¨ í›„, ```wait()```ì„ í˜¸ì¶œí•˜ì—¬ ìê¸° ìì‹ ì˜ ìƒíƒœë¥¼ ì¼ì‹œ ì •ì§€ ìƒíƒœë¡œ ì „í™˜í•œë‹¤.

```java
public class ThreadExample5 {
    public static void main(String[] args) {
        WorkObject sharedObject = new WorkObject();

        ThreadA threadA = new ThreadA(sharedObject);
        ThreadB threadB = new ThreadB(sharedObject);

        threadA.start();
        threadB.start();
    }
}

class WorkObject {
    public synchronized void methodA() {
        System.out.println("ThreadAì˜ methodA Working");
        notify();
        try { wait(); } catch(Exception e) {}
    }

    public synchronized void methodB() {
        System.out.println("ThreadBì˜ methodB Working");
        notify();
        try { wait(); } catch(Exception e) {}
    }
}

class ThreadA extends Thread {
    private WorkObject workObject;

    public ThreadA(WorkObject workObject) {
        this.workObject = workObject;
    }

    public void run() {
        for(int i = 0; i < 10; i++) {
            workObject.methodA();
        }
    }
}

class ThreadB extends Thread {
    private WorkObject workObject;

    public ThreadB(WorkObject workObject) {
        this.workObject = workObject;
    }

    public void run() {
        for(int i = 0; i < 10; i++) {
            workObject.methodB();
        }
    }
}
```

<br>

***

_2022.09.18. Update_