# í…ŒìŠ¤íŒ…

ì–´í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•œ í…ŒìŠ¤íŒ…ì„ í†µí•´, ì œ 3ìê°€ ì—ëŸ¬(ë²„ê·¸)ë¥¼ ë°œê²¬í•˜ëŠ” ê²ƒì„ ìµœì†Œí™” í•  ìˆ˜ ìˆë‹¤.

í…ŒìŠ¤íŠ¸ëŠ” ëŒ€ìƒì´ ê²€ì¦ ê³¼ì •ì— ì˜ í†µê³¼í•˜ê²Œ ë§Œë“¤ì–´ **ìµœëŒ€í•œ ë” ë‚˜ì€ ê²°ê³¼**ë¥¼ ì–»ê¸° ìœ„í•œ ê³¼ì •ì´ë‹¤.

<br>

<img src = "../src/test.png" width = 600>

â–² _ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì¼ë°˜ì ì¸ í…ŒìŠ¤íŠ¸ ë¶„ë¥˜_

<br>

- ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸ : ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ì‚¬ìš©ì ì…ì¥ì—ì„œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì´ ì œê³µí•˜ëŠ” ê¸°ëŠ¥ì´ ì˜¬ë°”ë¥´ê²Œ ë™ì‘í•˜ëŠ”ì§€ í…ŒìŠ¤íŠ¸ (ì£¼ë¡œ QAì—ì„œ í•¨)

- í†µí•© í…ŒìŠ¤íŠ¸ : í´ë¼ì´ì–¸íŠ¸ ì¸¡ íˆ´ ì—†ì´ ê°œë°œìê°€ ì§  í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ í†µí•´ í…ŒìŠ¤íŠ¸

- ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ (ë¶€ë¶„ í†µí•© í…ŒìŠ¤íŠ¸) : ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ íŠ¹ì • ê³„ì¸µìœ¼ë¡œ ë‚˜ëˆ„ì–´ í…ŒìŠ¤íŠ¸

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ : ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì˜ ë©”ì„œë“œ ë‹¨ìœ„ë¡œ ë‚˜ëˆ„ì–´ í…ŒìŠ¤íŠ¸

<br>

**ğŸ’¡ Given - When - Then íŒ¨í„´**

í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‘ì„± ì‹œ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´ìœ¼ë¡œ ```ì¤€ë¹„ - ì‹¤í–‰ - ê²€ì¦```ì˜ ì„¸ ë¶€ë¶„ìœ¼ë¡œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‘ì„±í•œë‹¤.

- **Given** : í…ŒìŠ¤íŠ¸ì— ì‚¬ìš©í•˜ëŠ” ë³€ìˆ˜, ì´ˆê¸° ë°ì´í„°, ì…ë ¥ ê°’ ë“±ì„ ì •ì˜í•˜ê±°ë‚˜ Mock ê°ì²´ë¥¼ ì •ì˜í•˜ëŠ” êµ¬ë¬¸ì´ í¬í•¨ëœë‹¤.

- **When** : ì‹¤ì œë¡œ í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ê¸°ëŠ¥ì´ ë™ì‘í•˜ëŠ” ë‹¨ê³„ë¡œ, í…ŒìŠ¤íŠ¸ì˜ ì‹¤ì œ ì¶œë ¥ê°’ Actualì´ í¬í•¨ëœë‹¤.  

- **Then** : ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§„ ê°’ê³¼ ì¶œë ¥ì„ í†µí•´ ë‚˜ì˜¨ ì¶œë ¥ ê°’ì„ Assertion(ê²€ì¦)í•˜ëŠ” ë‹¨ê³„ì´ë‹¤.

<br>

***

<br>

## ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ (Unit Test)

ì‘ì€ ë‹¨ìœ„ì¼ ìˆ˜ë¡ ì—°ê´€ëœ ê¸°ëŠ¥ì„ ìƒê°í•  í•„ìš” ì—†ì´, ë‹¨ìˆœí•˜ê³  ë¹ ë¥´ê²Œ í…ŒìŠ¤íŠ¸ë¥¼ ìˆ˜í–‰í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ

ì¼ë°˜ì ìœ¼ë¡œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” **ìµœëŒ€í•œ ë…ë¦½ì ì¸ ê²ƒ**ì´ ì¢‹ê³ , **ìµœëŒ€í•œ ì‘ì€ ë‹¨ìœ„**ë¡œ ìª¼ê°œì–´ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

<br>

**ğŸ’¡ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ í•˜ëŠ” ì´ìœ **

- êµ¬í˜„í•œ ì½”ë“œê°€ ì˜ë„í•œ ëŒ€ë¡œ ë™ì‘í•˜ëŠ”ì§€ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ë¹ ë¥´ê²Œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

- ì‘ì€ ë‹¨ìœ„ì˜ í…ŒìŠ¤íŠ¸ë¡œ ë²„ê·¸ë¥¼ ë¯¸ë¦¬ ì°¾ì•„ë‚¼ ìˆ˜ ìˆì–´ì„œ ìƒëŒ€ì ìœ¼ë¡œ ë” ì ì€ ì‹œê°„ ì•ˆì— ë¬¸ì œë¥¼ ì°¾ì•„ë‚¼ ê°€ëŠ¥ì„±ì´ ë†’ë‹¤.

<br>

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ FIRST ì›ì¹™

**ğŸ”¸ Fast (ë¹ ë¥´ê²Œ)**

- ì¼ë°˜ì ìœ¼ë¡œ ì‘ì„±í•œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ë¹ ë¥´ê²Œ ë™ì‘í•´ì•¼í•œë‹¤.

<br>

**ğŸ”¸ Independent (ë…ë¦½ì ìœ¼ë¡œ)**

- ê°ê°ì˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ë…ë¦½ì ì´ì—¬ì•¼ í•œë‹¤.

<br>

**ğŸ”¸ Repeatable (ë°˜ë³µ ê°€ëŠ¥í•˜ë„ë¡)**

- í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ëŠ” ì–´ë– í•œ í™˜ê²½ì—ì„œë„ ë°˜ë³µ ì‹¤í–‰ì´ ê°€ëŠ¥í•´ì•¼í•œë‹¤.

- ì™¸ë¶€ ì„œë¹„ìŠ¤ë‚˜ ë¦¬ì†ŒìŠ¤ê°€ ì—°ë™ë˜ëŠ” ê²½ìš° ë™ì¼í•œ í…ŒìŠ¤íŠ¸ ê²°ê³¼ë¥¼ ë³´ì¥í•˜ì§€ ëª»í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì—,  
  ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‹œì—ëŠ” ì™¸ë¶€ ì„œë¹„ìŠ¤ë‚˜ ë¦¬ì†ŒìŠ¤ì˜ ì—°ë™ì„ ëŠì–´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.

<br>

**ğŸ”¸ Self-Validating (ìê°€ ê²€ì¦ì´ ë˜ë„ë¡)**

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ìŠ¤ìŠ¤ë¡œ ì„±ê³µ ë˜ëŠ” ì‹¤íŒ¨ë¼ëŠ” ìì²´ ê²€ì¦ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ì–´ì•¼ í•œë‹¤.

<br>

**ğŸ”¸ Timely (ì‹œê¸° ì ì ˆí•˜ê²Œ)**

- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ëŠ” í…ŒìŠ¤íŠ¸í•˜ë ¤ëŠ” ê¸°ëŠ¥ êµ¬í˜„ì„ í•˜ê¸° ì§ì „ì— ì‘ì„±í•´ì•¼í•œë‹¤.  
- ì •í™•íˆëŠ” êµ¬í˜„í•˜ê³ ì í•˜ëŠ” ê¸°ëŠ¥ì„ ë‹¨ê³„ì ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ë©´ì„œ, ê·¸ë•Œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë„ ë‹¨ê³„ì ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.

<br><br>

### Junitì„ í™œìš©í•œ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸

Junitì€ Java ì–¸ì–´ë¡œ ë§Œë“¤ì–´ì§„ ì–´í”Œë¦¬ì¼€ì´ì…˜ìš© ì˜¤í”ˆ ì†ŒìŠ¤ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì´ë©°, Spring Bootì˜ ê¸°ë³¸ í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì´ë‹¤.

Junitì€ 2022ë…„ í˜„ì¬ Junit 5ê¹Œì§€ ë¦´ë¦¬ì¦ˆ ë˜ì—ˆìœ¼ë©°, ì´ì™¸ì—ë„ TestNGì™€ ê°™ì€ í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ í”„ë ˆì„ì›Œí¬ê°€ ì¡´ì¬í•œë‹¤.

<br>

```java
dependencies {
  testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
```

ìœ„ì™€ ê°™ì´ ì„¤ì •í•˜ì—¬ Junitì„ ì‚¬ìš©í•  ìˆ˜ ìˆìœ¼ë©°, Spring Boot Initializerë¥¼ ì´ìš©í•˜ë©´ ê¸°ë³¸ì ìœ¼ë¡œ í¬í•¨ëœë‹¤.

<br>

**ğŸ”¸ Junit í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ê¸°ë³¸ êµ¬ì¡°**

```java
public class JunitDefaultStructure {
  @Test
  public void test1() { ... }

  @Test
  public void test2() { ... }
}
```

í…ŒìŠ¤íŠ¸í•˜ê³ ì í•˜ëŠ” ëŒ€ìƒì— ëŒ€í•´ ```void``` íƒ€ì…ì˜ ë©”ì„œë“œë¥¼ ë§Œë“¤ê³ , ```@Test``` ì–´ë…¸í…Œì´ì…˜ì„ ì…ë ¥í•˜ë©´ ëœë‹¤.

<br>

- ```@DisplayName("~")``` : í…ŒìŠ¤íŠ¸ ê²°ê³¼ì— ë‚˜íƒ€ë‚¼ ì´ë¦„ì„ ì„¤ì •í•œë‹¤.

- ```@BeforeEach``` : ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ ì „ì— í•´ë‹¹ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œë‹¤. ì£¼ë¡œ ì´ˆê¸°í™” ì‘ì—…ì— ì‚¬ìš©

- ```@BeforeAll``` : ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ ì „ì— í•´ë‹¹ ë©”ì„œë“œë¥¼ 1ë²ˆë§Œ ì‹¤í–‰í•œë‹¤. **static ë©”ì„œë“œì—ë§Œ ì‚¬ìš© ê°€ëŠ¥**

- ```@AfterEach``` : ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ í›„ì— í•´ë‹¹ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•œë‹¤. ì£¼ë¡œ í›„ì²˜ë¦¬ ì‘ì—…ì— ì‚¬ìš©

- ```@AfterAll``` : ëª¨ë“  í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ í›„ì— í•´ë‹¹ ë©”ì„œë“œë¥¼ 1ë²ˆë§Œ ì‹¤í–‰í•œë‹¤.

<br><br>

#### ğŸ“Œ **Assertion**

Assertionì€ **ì˜ˆìƒí•˜ëŠ” ê²°ê³¼ê°€ ì°¸(true)ì´ê¸¸ ë°”ë¼ëŠ” ë…¼ë¦¬ì ì¸ í‘œí˜„**ì´ë©°, **ê²€ì¦**ì´ë¼ê³  í•  ìˆ˜ ìˆë‹¤.

Junitì—ì„œëŠ” Assertionì˜ ë‹¤ì–‘í•œ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•´ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì— ëŒ€í•œ ê²€ì¦ì„ ì§„í–‰í•  ìˆ˜ ìˆë‹¤.

<br>

**ğŸ”¸ assertEquals(), assertNotEquals()**

ê¸°ëŒ€ ê°’ê³¼ ì‹¤ì œ ê°’ì´ ê°™ì€ì§€, ê°™ì§€ ì•Šì€ì§€ ê²€ì¦í•œë‹¤.

```java
@Test
public void testExample() {
  String expected = "Hello, Junit";
  String actual = "Hello, Junit";

  assertEquals(expected, actual);
}
```

<br>

**ğŸ”¸ assertNull(), assertionNotNull()**

ëŒ€ìƒ ê°ì²´ê°€ nullì¸ì§€, nullì´ ì•„ë‹Œì§€ ê²€ì¦í•œë‹¤.  
1ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” í…ŒìŠ¤íŠ¸ ëŒ€ìƒ ê°ì²´ì´ë©°, 2ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ì‹œ í‘œì‹œí•  ë©”ì‹œì§€ì´ë‹¤.

```java
@Test
public void testExample() {
  String obj = null;
  String notNullObj = "hi";

  assertNull(obj, "have to be null");
  // ë˜ëŠ”
  assertNotNull(notNullObj, "should be not null");
}
```

<br>

**ğŸ”¸ assertThrows(), assertDoesNotThrows()**

ëŒ€ìƒ ì˜ˆì™¸ë¥¼ ë°œìƒì‹œí‚¤ëŠ”ì§€, ë°œìƒì‹œí‚¤ì§€ ì•ŠëŠ”ì§€ ê²€ì¦í•œë‹¤.  
1ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” ë°œìƒì´ ê¸°ëŒ€ë˜ëŠ” ì˜ˆì™¸ í´ë˜ìŠ¤, 2ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì—ëŠ” ëŒë‹¤ í‘œí˜„ì‹ì„ í†µí•´ ë©”ì„œë“œë¥¼ í˜¸ì¶œí•œë‹¤.

```java
@Test
public void testExample() {
  String obj = null;

  assertThrows(NullPointerException.class, () -> obj.toUpperCase());
}
```

ë°œìƒì´ ê¸°ëŒ€ë˜ëŠ” ì˜ˆì™¸ê°€ ì•„ë‹Œ ë‹¤ë¥¸ ì˜ˆì™¸ê°€ ë°œìƒí–ˆë‹¤ë©´ ê²€ì¦ì— ì‹¤íŒ¨í•œë‹¤.  

í•˜ì§€ë§Œ ```NullPointerException```ì˜ ìƒìœ„ í´ë˜ìŠ¤ì¸ ```RuntimeException```ì„ ê¸°ëŒ€ê°’ìœ¼ë¡œ ì„¤ì •í•˜ë©´ ê²€ì¦ì— ì„±ê³µí•œë‹¤.

ì´ì²˜ëŸ¼ ë°œìƒì´ ê¸°ëŒ€ë˜ëŠ” ì˜ˆì™¸ì˜ ìƒìœ„ í´ë˜ìŠ¤ë¥¼ ì¸ìë¡œ ì „ë‹¬í•œ ê²½ìš°ì—ëŠ” ê²€ì¦ì— ì„±ê³µí•œë‹¤.

<br>

> **ğŸ’¡ Executable í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤**
>
> 2ë²ˆì§¸ íŒŒë¼ë¯¸í„°ì¸ ëŒë‹¤ í‘œí˜„ì‹ì€ Executable í•¨ìˆ˜í˜• ì¸í„°í˜ì´ìŠ¤ì´ë‹¤.
>
> Consumer ì¸í„°í˜ì´ìŠ¤ë¼ê³  ë¶ˆë¦¬ëŠ” ë§¤ê°œë³€ìˆ˜ëŠ” ì¡´ì¬í•˜ì§€ë§Œ ë°˜í™˜ê°’ì€ ì—†ëŠ” ì¸í„°í˜ì´ìŠ¤ì´ë©°,  
> ```void execute() throws Throwable;``` ë©”ì„œë“œ í•˜ë‚˜ë§Œ ì •ì˜ë˜ì–´ ìˆë‹¤.

<br>

### ğŸ“‹ [***Assertionì— ëŒ€í•œ ë” ë§ì€ ì •ë³´***](https://junit.org/junit5/docs/current/user-guide/#writing-tests-assertions)

<br><br>

#### ğŸ“Œ **Hamcrest**

HamcrestëŠ” Junit ê¸°ë°˜ì˜ ë‹¨ìœ„í…ŒìŠ¤íŠ¸ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” Assertion Frameworkì´ë‹¤.

ìì—°ìŠ¤ëŸ¬ìš´ ë¬¸ì¥í˜• Mathcerë¡œ ê°€ë…ì„±ì„ í–¥ìƒ ì‹œí‚¬ ìˆ˜ ìˆê³ , í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ ë©”ì‹œì§€ë¥¼ ì´í•´í•˜ê¸° ì‰½ë‹¤ëŠ” ì¥ì ì´ ìˆë‹¤.

<br>

```java
@Test
public void testExample() {
  String expected = "Hello, World";
  String actual = "Hello, Junit";

  // Junitì˜ Assertion
  assertEquals(expected, actual);

  // Hamcrestì˜ Matcher
  assertThat(actual, is(equalTo(expected)));
}
```
â–² _Hamcrestë¥¼ ì‚¬ìš©í•˜ë©´ í•˜ë‚˜ì˜ ì˜ì–´ ë¬¸ì¥ì²˜ëŸ¼ ìì—°ìŠ¤ëŸ½ê²Œ ì½í˜€ ê°€ë…ì„± ì¸¡ë©´ì—ì„œ ì¥ì ì´ ìˆë‹¤._

<br>

- ```assertThat()``` : 1ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” ì‹¤ì œ ê°’, 2ë²ˆì§¸ íŒŒë¼ë¯¸í„°ëŠ” ê¸°ëŒ€í•˜ëŠ” ê°’ì´ë‹¤.

<br><br>

#### ğŸ“Œ **Assumption**

Assumptionì€ '~ë¼ê³  ê°€ì •í•˜ê³ 'ë¼ëŠ” ëœ»ì´ë©°,  íŠ¹ì • í™˜ê²½ì—ë§Œ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë¥¼ ì‹¤í–‰í•˜ë„ë¡ í•  ë•Œ ì‚¬ìš©í•œë‹¤.

<br>

**ğŸ”¸ assumeTrue()**

íŒŒë¼ë¯¸í„°ë¡œ ì…ë ¥ëœ ê°’ì´ trueì´ë©´ ì•„ë˜ì— ìˆëŠ” ë‚˜ë¨¸ì§€ ë¡œì§ì„ ì‹¤í–‰

```java
@Test
public void testExample() {
  assumeTrue(System.getProperty("os.name").startWith("Mac OS X"));

  System.out.println("success");
  assertTrue(true);
}
```

<br>

### ğŸ“‹ [***Assumptionì— ëŒ€í•œ ë” ë§ì€ ì •ë³´***](https://junit.org/junit5/docs/current/user-guide/#writing-tests-assumptions)

<br>

***

<br>

## ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ (Slice Test)

ê° ê³„ì¸µì— êµ¬í˜„í•œ ê¸°ëŠ¥ë“¤ì´ ì˜ ë™ì‘í•˜ëŠ”ì§€ íŠ¹ì • ê³„ì¸µë§Œ ì˜ë¼ì„œ ì§„í–‰í•˜ëŠ” í…ŒìŠ¤íŠ¸ë¥¼ ë§í•œë‹¤.

ê° ê³„ì¸µì€ ì„œë¡œ ì—°ê²°ë˜ì–´ ìˆê¸° ë•Œë¬¸ì— ê³„ì¸µì„ ë”°ë¡œë”°ë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•´ì„œëŠ” Mock(ê°€ì§œ ê°ì²´)ì„ ì‚¬ìš©í•´ì•¼í•œë‹¤.

<br>

**ğŸ’¡ Mockito**

- Spring Framework ìì²´ì ìœ¼ë¡œ ì§€ì›í•˜ëŠ” Mock ê°ì²´ë¥¼ í†µí•œ Mockingì„ í•´ì£¼ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ë¼ì´ë¸ŒëŸ¬ë¦¬

<br><br>

### Presentation Layer í…ŒìŠ¤íŠ¸

í•´ë‹¹ ê³„ì¸µì—ì„œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì€ ëŒ€ë¶€ë¶„ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°›ì•„ë“¤ì´ëŠ” í•¸ë“¤ëŸ¬ì¸ Controllerì´ë‹¤.

<br>

**ğŸ”¸ Controller í…ŒìŠ¤íŠ¸**

```java
@SpringBootTest
@AutoConfigureMockMvc
public class MemberControllerTest {

  @Autowired
  private MockMvc mockMvc;

  @Autowired
  private Gson gson;
    
  @MockBean
  private MemberService memberService;

  @Autowired
  private MemberMapper mapper;

  @Test
  public void postMemberTest() throws Exception {
    // given : í…ŒìŠ¤íŠ¸ìš© request body ìƒì„±
    MemberDto.Post post 
              = new MemberDto.Post("hongjjwan@gmail.com", "Hong", "010-1234-1234");
    
    Member member = mapper.memberPostToMember(post);
    member.setStamp(new Stamp()); // Member Entityì˜ stamp ì •ë³´ê°€ ì—†ìœ¼ë©´ Exception ë°œìƒ

    given(memberService.createMember(Mockito.any(Member.class))).willReturn(member);

    String content = gson.toJson(post);


    // when : MockMvc ê°ì²´ë¡œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒ Controller í˜¸ì¶œ
    // - MockMvc ê°ì²´ë¥¼ í†µí•´ ìš”ì²­ URIì™€ HTTP ë©”ì„œë“œ ë“±ì„ ì§€ì •í•˜ê³ , 
    // - request bodyë¥¼ ì¶”ê°€í•œ ë’¤ì— request ìˆ˜í–‰
    ResultActions actions =
            mockMvc.perform(post("/v11/members")
                            .accept(MediaType.APPLICATION_JSON)
                            .contentType(MediaType.APPLICATION_JSON)
                            .content(content));

        
    // then : Controllerì˜ ë©”ì„œë“œì—ì„œ ì‘ë‹µìœ¼ë¡œ ìˆ˜ì‹ í•œ HTTP Status ë° response bodyë¥¼ í†µí•œ ê²€ì¦ 
    MvcResult result = actions
                        .andExpect(status().isCreated())
                        .andExpect(jsonPath("$.data.email").value(post.getEmail()))
                        .andExpect(jsonPath("$.data.name").value(post.getName()))
                        .andExpect(jsonPath("$.data.phone").value(post.getPhone()))
                        .andReturn();

    System.out.println(result.getResponse().getContentAsString());
  }
}
```

<br>

**1. ì–´ë…¸í…Œì´ì…˜**

- ```@SpringBootTest``` : Sprint Boot ê¸°ë°˜ì˜ ì–´í”Œë¦¬ì¼€ì´ì…˜ì„ í…ŒìŠ¤íŠ¸í•˜ê¸° ìœ„í•œ Application Contextë¥¼ ìƒì„±

- ```@WebMvcTest``` : @SpringBootTest ëŒ€ì‹ ì— ì‚¬ìš© ê°€ëŠ¥í•˜ë©°, Controllerì—ì„œ ì˜ì¡´í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë¥¼ ì¼ì¼ì´ ì„¤ì •í•´ì•¼í•œë‹¤.

- ```@AutoConfigureMockMvc``` : Controller í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ìë™ êµ¬ì„± ì‘ì—…

<br>

> **ğŸ’¡ ```@SpringBootTest``` vs ```@WebMvcTest```**
>
> ```@SpringBootTest```ëŠ” ```@AutoConfigureMockMvc```ì™€ í•¨ê»˜ ì‚¬ìš©ë˜ì–´ Controllerë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ”ë°,  
> í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” Bean ì „ì²´ë¥¼ ApplicationContextì— ë“±ë¡í•˜ì—¬ ì‚¬ìš©í•œë‹¤.
> 
> â†’ í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì„±ì€ í¸ë¦¬í•˜ì§€ë§Œ, ì‹¤í–‰ ì†ë„ê°€ ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦¬ë‹¤. **í†µí•© í…ŒìŠ¤íŠ¸ì— ì£¼ë¡œ ì‚¬ìš©**
>
> ```@WebMvcTest```ëŠ” Controller í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ Beanë§Œ ApplicationContextì— ë“±ë¡í•œë‹¤.
>
> â†’ í…ŒìŠ¤íŠ¸ í™˜ê²½ êµ¬ì„±ì€ ë¶ˆí¸í•˜ì§€ë§Œ, ì‹¤í–‰ ì†ë„ê°€ ìƒëŒ€ì ìœ¼ë¡œ ë¹ ë¥´ë‹¤. **Controller ìŠ¬ë¼ì´ìŠ¤ í…ŒìŠ¤íŠ¸ì— ì£¼ë¡œ ì‚¬ìš©**

<br>

**2. ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° í”„ë ˆì„ì›Œí¬**

- ```MockMvc``` : Tomcatê³¼ ê°™ì€ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ì§€ ì•Šê³ , Controllerë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ì§€ì›í•˜ëŠ” Spring MVC í”„ë ˆì„ì›Œí¬  
  > @AutoConfigureMockMvc ì–´ë…¸í…Œì´ì…˜ì„ ì‘ì„±í•´ì•¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

- ```Gson``` : JSON ë³€í™˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ì•„ë˜ì™€ ê°™ì€ ì„¤ì •ì„ ì¶”ê°€í•˜ì—¬ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

  ```java
  dependencies {
    implementation 'com.google.code.gson:gson'
  }
  ```

- ```@MockBean``` : Application Contextì— ë“±ë¡ëœ Beanì— ëŒ€í•œ Mockito Mock ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì£¼ì…í•˜ëŠ” ì—­í•   
  - ì–´ë…¸í…Œì´ì…˜ì´ ì‘ì„±ë˜ë©´ í•´ë‹¹ í•„ë“œì˜ Beanì— ëŒ€í•œ Mock ê°ì²´ë¥¼ ìƒì„±í•˜ê³ , í•„ë“œì— ì£¼ì…(DI)í•˜ê²Œ ëœë‹¤.

<br>

**3. Given**

- ```given``` : Mock ê°ì²´ê°€ íŠ¹ì • ê°’ì„ ë¦¬í„´í•˜ëŠ” ë™ì‘ì„ ì§€ì •í•˜ëŠ” static ë©”ì„œë“œ  
  ì‹¤ì œ Controller í´ë˜ìŠ¤ì—ì„œ ì‚¬ìš©ë˜ëŠ” ë¡œì§ì„ ì…ë ¥í•´ í…ŒìŠ¤íŠ¸í•œë‹¤.
  
  > import static org.mockito.BDDMockito.given;

- ```Mockito.any(í´ë˜ìŠ¤ íƒ€ì…)``` : Mockitoì—ì„œ ì§€ì›í•˜ëŠ” ë³€ìˆ˜ íƒ€ì…ìœ¼ë¡œ, í•´ë‹¹ ë¡œì§ì˜ íŒŒë¼ë¯¸í„° íƒ€ì…ì„ ì…ë ¥í•´ì¤€ë‹¤.

  > ```anyInt()```, ```anyLong()```, ```anyList()``` ë“±ìœ¼ë¡œ íƒ€ì…ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.

- ```doNothing()``` : voidë¡œ ì„ ì–¸ëœ ë©”ì„œë“œì— ```when()```ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.

- ```when()``` : mock ê°ì²´ì˜ í–‰ë™ì„ ì„¤ì •í•œë‹¤.

  > ex) ```doNothing().when(memberService).deleteMember(memberId);```

- ```willReturn()``` : MemberService Mock ê°ì²´ì˜ createMember() ë©”ì„œë“œê°€ ë¦¬í„´í•  Stub ë°ì´í„°

  > **ğŸ’¡ Stubbing**
  >
  > í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ í•­ìƒ Mock ê°ì²´ê°€ ì¼ì •í•œ ë™ì‘ì„ í•˜ë„ë¡ ì§€ì •í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.

<br>

**4. When**

- ```perform()``` : ìš”ì²­ì„ ì „ì†¡í•˜ëŠ” ì—­í• ì„ í•˜ë©°, ë©”ì„œë“œ ë‚´ë¶€ì—ëŠ” Controller í˜¸ì¶œì„ ìœ„í•œ ì„¸ë¶€ ì •ë³´ê°€ í¬í•¨ëœë‹¤.   
  
  > ```ResultActions``` ê°ì²´ë¥¼ ë°›ìœ¼ë©°, í•´ë‹¹ ê°ì²´ëŠ” ë¦¬í„´ ê°’ì„ ê²€ì¦í•˜ê³  í™•ì¸í•˜ëŠ” ```andExpect()``` ë©”ì„œë“œë¥¼ ì œê³µí•œë‹¤.

- ```post(), get(), put(), delete()``` : HTTP POST METHODì™€ Request URLì„ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

  > import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;

- ```accept()``` : í´ë¼ì´ì–¸íŠ¸ ìª½ì—ì„œ ë¦¬í„´ ë°›ì„ ì‘ë‹µ ë°ì´í„° íƒ€ì…ì„ ì„¤ì •í•œë‹¤.

- ```contentType()``` : ì„œë²„ ìª½ì—ì„œ ì²˜ë¦¬ ê°€ëŠ¥í•œ Content Typeì„ ì„¤ì •í•œë‹¤.

- ```content()``` : Request Body ë°ì´í„°ë¥¼ ì„¤ì •í•œë‹¤.

- ì´ì™¸ì—ë„ ```param("size", String.valueOf(pageMembers.getSize()))```ê³¼ ê°™ì´  
  Query Parameterë¡œ ì…ë ¥ë˜ëŠ” ê°’ì— ëŒ€í•œ ì„¤ì •ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.

<br>

**5. Then**

- ```status()``` : Response Statusê°€ ë’¤ì— ì˜¤ëŠ” ìƒíƒœê°€ ë§ëŠ”ì§€ í™•ì¸í•˜ëŠ” static ë©”ì„œë“œ  
  
  > import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;

- ```andExpect()``` : ResultActionsì—ì„œ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¡œ, ë¦¬í„´ìœ¼ë¡œ ì „ì†¡í•œ Requestì— ëŒ€í•œ ê²€ì¦ì„ ìˆ˜í–‰í•œë‹¤.

- ```andReturn()``` : MvcResultì—ì„œ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¡œ, ë””ë²„ê¹… ì‹œ Responseë¡œ ì „ë‹¬ë˜ëŠ” ì‘ë‹µ ë°ì´í„°ë¥¼ ì¶œë ¥í•  ë•Œ ì‚¬ìš©í•œë‹¤.

- ```jsonPath("$.data").value()``` : JsonPathì˜ ê°’ê³¼ valueì˜ ì¸ì ê°’ì´ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸í•œë‹¤. (```$```ëŠ” ë£¨íŠ¸)

- ```jsonPath().isArray()``` : JSì˜ ë°°ì—´ì¸ì§€ í™•ì¸í•œë‹¤. (Javaì˜ Collectionë„ JSì—ì„œëŠ” ë°°ì—´ë¡œ ì·¨ê¸‰)
  
  > import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;

  ### ğŸ“‹ [***JsonPath***](https://joojimin.tistory.com/52)

<br><br>

### Service Layer í…ŒìŠ¤íŠ¸

í•´ë‹¹ ê³„ì¸µì—ì„œ í…ŒìŠ¤íŠ¸ ëŒ€ìƒì€ ëŒ€ë¶€ë¶„ í´ë¼ì´ì–¸íŠ¸ ìš”ì²­ì„ ë°›ì•„ë“¤ì´ëŠ” í•¸ë“¤ëŸ¬ì¸ Controllerì´ë‹¤.

<br>

**ğŸ”¸ Service í…ŒìŠ¤íŠ¸**

```java
@ExtendWith(MockitoExtension.class)
public class MemberServiceMockTest {

  @Mock
  private MemberRepository memberRepository;

  @InjectMocks
  private MemberService memberService;

  @Test
  public void createMemberTest() {
    // given
    Member member = new Member("hongjjwan@gmail.com", "Hong", "010-1123-1231");

    given(memberRepository.findByEmail(member.getEmail))
            .willReturn(Optional.of(member));

    // when, then
    assertThrows(BusinessLogicException.class, 
                    () -> memberService.createMember(member));
  }
}
```

<br>

- ```@ExtendWith``` : Springì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ , Junitì˜ Mockito ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ì–´ë…¸í…Œì´ì…˜

- ```@Mock``` : í•´ë‹¹ í•„ë“œì˜ ê°ì²´ë¥¼ Mock ê°ì²´ë¡œ ìƒì„±í•œë‹¤.

- ```@InjectMocks``` : ```@Mock```ì„ í†µí•´ ìƒì„±í•œ Mock ê°ì²´ë¥¼ í•´ë‹¹ í•„ë“œì— ì£¼ì…í•œë‹¤.



<br><br>

### Data Access Layer í…ŒìŠ¤íŠ¸

ë°ì´í„° ì•¡ì„¸ìŠ¤ ê³„ì¸µ í…ŒìŠ¤íŠ¸ ì‹œì—ëŠ” ```DBì˜ ìƒíƒœë¥¼ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ ì´ì „ìœ¼ë¡œ ë˜ëŒë ¤ ê¹¨ë—í•˜ê²Œ í•œë‹¤```ëŠ” ê·œì¹™ì„ ì§€í‚¤ëŠ” ê²ƒì´ ì¢‹ë‹¤.

<br>

**ğŸ”¸ Repository í…ŒìŠ¤íŠ¸**

```java
@DataJpaTest
public class MemberRepositoryTest {

  @Autowired
  private MemberRepository memberRepository;

  @Test
  public void savedMemberTest() {
    // given
    Member member = new Member();
    member.setEmail("hongjjwan@gmail.com");
    member.setName("Hong");
    member.setPhone("010-1111-2222");

    // when
    Member savedMember = memberRepository.save(member);

    // then
    assertNotNull(savedMember);
    assertEquals(member.getEmail(), savedMember.getEmail());
    assertEquals(member.getName(), savedMember.getName());
    assertEquals(member.getPhone(), savedMember.getPhone());
  }

  @Test
  public void findByEmailTest() {
    // given
    Member member = new Member();
    member.setEmail("hongjjwan@gmail.com");
    member.setName("Hong");
    member.setPhone("010-1111-2222");

    // when
    memberRepository.save(member);
    Optional<Member> findMember = 
                memberRepository.findByEmail(member.getEmail());

    // then
    assertTrue(findMember.isPresent());
    assertEquals(findMember.get().getEmail(), member.getEmail());
  }
}
```

<br>

- ```@DataJpaTest``` : ```@Transaction```ì„ í¬í•¨í•˜ê³  ìˆê¸° ë•Œë¬¸ì—, í•˜ë‚˜ì˜ í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ ì‹¤í–‰ì´ ì¢…ë£Œë˜ëŠ” ì‹œì ì— **DBì— ì €ì¥ëœ ë°ì´í„°ëŠ” rollback ì²˜ë¦¬**ë˜ì–´ ì´ˆê¸° ìƒíƒœë¥¼ ìœ ì§€í•œë‹¤.

  > Spring JDBC í™˜ê²½ì—ì„œëŠ” ```@JdbcTest```, Spring Data JDBC í™˜ê²½ì—ì„œëŠ” ```@DataJdbcTest```ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

<br><br>

***

_2022.11.16. Modified_

_2022.11.14. Update_

_2022.11.13. Modified_

_2022.11.12. Update_

_2022.11.09. Update_